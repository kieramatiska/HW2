---
title: "Untitled"
author: "Kiera Matiska"
date: "2/5/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# attach packages
library(tidyverse)
library(kableExtra)
```

## Read in data

```{r}
lizards <- read_csv("lizard.csv") # read in csv
```

## Start nonlinear Least Square Model

W = a*SVL^b

- W = weight
- SVL = snout to vent length
- a and b are the parameters needed to be fit

### Wrangle data

```{r}
# add some log columns of the data: length and width
lizards_log <- lizards %>% 
  mutate(log_length = log(SV_length)) %>% 
  mutate(log_weight = log(weight)) %>% 
  drop_na() # drop na values

lizards_model_guess <- lm(log_weight ~ log_length, data = lizards_log) # create a guess model using log values

conceptual_model <- function(a, SV_length, b) { # define the conceptual model
  W = a * SV_length ^ b
  return(W)
}

new_model <- function (a, SV_length, b) { # define the linear equation model
  ln(W) = ln(a) + b * ln(SV_length)
  print(W)
}

guess_coef <- coef(lizards_model_guess) # find the coefficients
```

### Write NLS model

```{r}
nls_lizards <- nls(weight ~ conceptual_model(a, SV_length, b),
                   data = lizards,
                   start = list(a = 2.718^(guess_coef[1]/guess_coef[2]),
                                b = guess_vec[2], trace = TRUE))
```

